智能合约：
- 安网4中的智能合约，我们称之为安码SafeCode。安网4拟采用以太坊EVM作为智能合约虚拟机，以方便各种ETH应用的合约移植。所有已经在ETH上运行的合约，皆可无缝在安网4上运行；同时通过EVM的开发工具链开发Solidity新合约，编译成字节码后在安网4上进行部署和调用。这种安排非常有利于在安网4中快速建立应用生态。
- 安网4是类比特币的UTXO账户模式，每笔费用都可追溯，每个交易中都包含过往资金来源并且签名；而EVM智能合约是银行账户模式，无需提供资金来源，只需不超过账户资金数量即可消费。因而在UTXO与EVM合约之间需要添加一个转换层以在UTXO基础上适配EVM智能合约，我们称之为账户转换层(Account Transform Layer, ATL)。
	ATL的作用，一方面在UTXO交易上提取和运行安码，另一方面把安码操作转换成UTXO交易存贮在区块链上。
- 在UTXO交易中嵌入、运行安码：
（1）安网4拟拓展比特币脚本，增加操作码OP_CREATE/OP_CALL/OP_SPEND，分别对应创建安码、调用安码、花费安码中的资产；
（2）OP_CREATE创建安码，在ScriptPub公钥脚本中嵌入安码字节码，生成安码ID，并且执行合约初始化函数；该交易UTXO的输出可花费；
（3）OP_CALL调用安码，在ScriptPub公钥脚本中嵌入安码ID、所调用的函数及传入参数，调用EVM执行该安码的函数；用该操作码可向本安码发送资产；
（4）OP_SPEND花费安码资产，以安码ID或发送到安码的UTXO交易输出为输入，构建ScriptPub公钥脚本以花费安码中的资产；该操作码可向其他安码或普通地址发送资产；
- 安码运行于UTXO上的EVM中，与ETH系统不尽相同，因此与ETH的智能合约有一些细微的差别。
- 安码的别名机制，安码在创建时或后续皆可命名为一个还未存在的名字，如myapp，别名有唯一性，其附带值为安码ID，后续如果重新部署了安码，使得安码ID改变，则可以更新此条别名记录，在使用安码接口时使用别名访问即可访问最新安码，但旧安码的资产无法转移到新安码上。
- 类似于ETH，安码的运行需要SAFE作为燃料GAS，以gaslimit和gasprice的乘积作为最终GAS费用，作为燃料的SAFE最终为区块生产者所获得；运行安码时预先支付一定数量的SAFE，如果SAFE有剩余，则由区块生产者在同一区块中构建一个交易返还剩余SAFE给安码调用人。
